<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="icon-192.png">
  <title>Tracker Scommesse</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header class="topbar">
    <div class="title">
      <div class="appname">Tracker Scommesse</div>
      <div class="subtitle" id="subtitle">Offline ‚Ä¢ PWA</div>
    </div>

    <div class="row gap">
      <button class="btn ghost" id="btnImport">Importa</button>
      <button class="btn ghost" id="btnBackup">Backup</button>
      <input id="fileImport" type="file" accept="application/json" style="display:none" />
    </div>
  </header>

  <main class="wrap">

    <!-- ===================== PAGE: AGGIUNGI ===================== -->
    <section class="page show" id="page-add">
      <section class="card">
        <div class="row between">
          <div>
            <div class="label">Budget iniziale</div>
            <div class="big" id="budgetStart">‚Ç¨ 0</div>
          </div>
          <div>
            <div class="label">Budget disponibile</div>
            <div class="big" id="budgetNow">‚Ç¨ 0</div>
          </div>
        </div>

        <div class="budgetActions">
          <input class="input" type="number" step="0.01" id="inpBudget" placeholder="Imposta budget iniziale (es. 100)" />
          <div class="budgetBtns">
            <button class="btn" id="btnSetBudget">Salva</button>
            <button class="btn danger" id="btnReset">Reset</button>
          </div>
        </div>

        <p class="hint">
          ‚úÖ Stake% √® sempre calcolato sul <b>budget iniziale</b>. <br>
          Il budget disponibile scende quando inserisci ‚ÄúIn corso‚Äù e risale quando chiudi. <br>
          Il grafico bankroll si muove solo a scommesse <b>chiuse</b>.
        </p>
      </section>

      <section class="card">
        <div class="h2">Aggiungi scommessa</div>

        <div class="grid">
          <label class="field">
            <span>Data</span>
            <input class="input" type="date" id="fDate" />
          </label>

          <label class="field">
            <span>Tipster</span>
            <input class="input" type="text" id="fTipster" placeholder="es. Marco" />
          </label>

          <label class="field col2">
            <span>Evento / Giocata</span>
            <input class="input" type="text" id="fDesc" placeholder="es. Over 2.5, 1X2, ecc." />
          </label>

          <label class="field">
            <span>Quota</span>
            <input class="input" type="number" step="0.01" id="fOdds" placeholder="es. 1.85" />
          </label>

          <label class="field">
            <span>Stake % (su budget iniziale)</span>
            <input class="input" type="number" step="0.01" id="fStakePct" placeholder="es. 5" />
          </label>

          <label class="field">
            <span>Puntata ‚Ç¨ (prioritaria)</span>
            <input class="input" type="number" step="0.01" id="fStakeAmt" placeholder="es. 10" />
          </label>

          <label class="field">
            <span>Esito</span>
            <select class="input" id="fOutcome">
              <option>In corso</option>
              <option>Vinta</option>
              <option>Persa</option>
              <option>Void</option>
            </select>
          </label>

          <div class="field">
            <span>&nbsp;</span>
            <button class="btn" id="btnAdd">Aggiungi</button>
          </div>
        </div>

        <p class="hint">Se inserisci sia Stake% che Puntata‚Ç¨, viene usata la Puntata‚Ç¨.</p>
      </section>
    </section>

    <!-- ===================== PAGE: SCOMMESSE ===================== -->
    <section class="page" id="page-bets">
      <section class="card">
        <div class="row between">
          <div class="h2">Scommesse</div>
          <div class="row gap">
            <select class="input" id="filterOutcome">
              <option value="Tutte">Tutte</option>
              <option value="In corso">In corso</option>
              <option value="Vinta">Vinta</option>
              <option value="Persa">Persa</option>
              <option value="Void">Void</option>
            </select>
            <input class="input" id="search" placeholder="Cerca tipster/evento..." />
          </div>
        </div>

        <div class="sectionTitle">In corso</div>
        <div class="table" id="listOpen"></div>

        <div class="sectionTitle" style="margin-top:14px;">Chiuse</div>
        <div class="table" id="listClosed"></div>

        <p class="hint">Bottoni rapidi per chiudere al volo oppure Modifica.</p>
      </section>
    </section>

    <!-- ===================== PAGE: GIORNI ===================== -->
    <section class="page" id="page-days">
      <section class="card">
        <div class="row between">
          <div class="h2">Giorni</div>
          <div class="hint">Profitto = solo scommesse chiuse (in corso non influenzano).</div>
        </div>

        <div class="table" id="daysList"></div>
      </section>
    </section>

    <!-- ===================== PAGE: STATISTICHE ===================== -->
    <section class="page" id="page-stats">
      <section class="card">
        <div class="h2">Statistiche</div>

        <div class="stats">
          <div class="stat"><div class="k">Scommesse</div><div class="v" id="sTotal">0</div></div>
          <div class="stat"><div class="k">Chiuse</div><div class="v" id="sClosed">0</div></div>
          <div class="stat"><div class="k">Win rate</div><div class="v" id="sWR">0%</div></div>
          <div class="stat"><div class="k">Puntato (chiuse)</div><div class="v" id="sStaked">‚Ç¨ 0</div></div>
          <div class="stat"><div class="k">Profitto (chiuse)</div><div class="v" id="sProfit">‚Ç¨ 0</div></div>
          <div class="stat"><div class="k">ROI</div><div class="v" id="sROI">0%</div></div>
        </div>

        <div class="charts">
          <div class="chartCard">
            <div class="chartTitle">Andamento bankroll (solo chiuse)</div>
            <canvas id="cBank" width="600" height="240"></canvas>
          </div>

          <div class="chartCard">
            <div class="chartTitle">Esiti (chiuse)</div>
            <canvas id="cPie" width="600" height="240"></canvas>
          </div>

          <div class="chartCard">
            <div class="chartTitle">Profitto per tipster (chiuse)</div>
            <canvas id="cTip" width="600" height="260"></canvas>
          </div>
        </div>
      </section>
    </section>

    <!-- ===================== PAGE: TIPSTER ===================== -->
    <section class="page" id="page-tipster">
      <section class="card">
        <div class="row between">
          <div class="h2">Tipster</div>
          <button class="btn ghost" id="btnTipRefresh">Aggiorna</button>
        </div>

        <div class="table" id="tipList"></div>
        <p class="hint">Statistiche calcolate sulle scommesse chiuse.</p>
      </section>
    </section>

  </main>

  <!-- Bottom nav -->
  <nav class="tabbar">
    <button class="tab active" data-page="page-add">‚ûï<span>Aggiungi</span></button>
    <button class="tab" data-page="page-bets">üìã<span>Scommesse</span></button>
    <button class="tab" data-page="page-days">üìÖ<span>Giorni</span></button>
    <button class="tab" data-page="page-stats">üìà<span>Stats</span></button>
    <button class="tab" data-page="page-tipster">üë§<span>Tipster</span></button>
  </nav>

  <!-- Modal edit -->
  <div class="modal" id="modal">
    <div class="sheet">
      <div class="row between">
        <div class="h2">Modifica scommessa</div>
        <button class="btn ghost" id="btnClose">Chiudi</button>
      </div>

      <div class="grid">
        <label class="field"><span>Data</span><input class="input" type="date" id="eDate"></label>
        <label class="field"><span>Tipster</span><input class="input" id="eTipster"></label>
        <label class="field col2"><span>Evento</span><input class="input" id="eDesc"></label>
        <label class="field"><span>Quota</span><input class="input" type="number" step="0.01" id="eOdds"></label>
        <label class="field"><span>Stake %</span><input class="input" type="number" step="0.01" id="eStakePct"></label>
        <label class="field"><span>Puntata ‚Ç¨</span><input class="input" type="number" step="0.01" id="eStakeAmt"></label>
        <label class="field"><span>Esito</span>
          <select class="input" id="eOutcome">
            <option>In corso</option><option>Vinta</option><option>Persa</option><option>Void</option>
          </select>
        </label>
        <div class="field"><span>&nbsp;</span><button class="btn" id="btnSave">Salva</button></div>
      </div>

      <div class="row between" style="margin-top:12px;">
        <button class="btn danger" id="btnDelete">Elimina</button>
        <div class="hint">Le modifiche ricalcolano budget e statistiche.</div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
